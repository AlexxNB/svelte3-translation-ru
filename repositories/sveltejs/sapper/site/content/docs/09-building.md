---
title: Сборка
---

До сих пор мы использовали `sapper dev` для сборки нашего приложения и запуска сервера для разработки. Но когда дело доходит до продакшена, нам нужна автономная оптимизированная сборка.

### sapper build

Эта команда упаковывает ваше приложение в директорию `__sapper__/build`. (Вы можете указать любую папку, а также изменить некоторые другие параметры — для получения дополнительной информации выполните `sapper build --help`.)

На выходе мы получаем Node приложение, которое вы можете запустить из корня проекта командой:

```bash
node __sapper__/build
```

### Поддержка браузеров

По умолчанию, ваше приложение собирается с поддержкой только последних версий современных браузеров. Если вы используете Rollup, вы можете использовать флаг `--legacy`<sup>1</sup> для создания второго бандла, который можно использовать для поддержки устаревших браузеров, таких как Internet Explorer. Sapper сам предоставит правильный пакет пользователю вашего приложения<sup>2</sup>.

При использовании флага `--legacy`, Sapper передаёт переменную окружения `SAPPER_LEGACY_BUILD` в конфиг Rollup. Затем Sapper собирает клиентский бандл два раза: первый с `SAPPER_LEGACY_BUILD` равной `true` и еще раз со значением `false`. В описании [sapper-template-rollup](https://github.com/sveltejs/sapper-template-rollup) есть пример использования такой конфигурации.<sup>3</sup>


Возможно, вам понадобится добавить этот флаг в скрипт в `package.json`:
```js
  "scripts": {
    "build": "sapper build --legacy",
  },
```

1. Эта опция не относится к опции `legacy` компилятора Svelte
2. Браузерам, которые не поддерживают `async/await`, будет передан бандл для устаревших браузеров
3. Вам также придется заполифилить те API, которые не поддерживаются в старых браузерах.
