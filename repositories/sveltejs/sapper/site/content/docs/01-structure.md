---
title: Структура приложения
---

Это просто раздел для любознательных.  Мы рекомендуем вам сначала поиграть с шаблоном проекта и вернуться сюда, когда прочувствуете как все вещи взаимосвязаны друг с другом.

Если вы загляните в внутрь шаблона [sapper-template](https://github.com/sveltejs/sapper-template), вы увидите несколько файлов, которые Sapper ожидает там найти:

```bash
├ package.json
├ src
│ ├ routes
│ │ ├ # тут ваши маршруты
│ │ ├ _error.svelte
│ │ └ index.svelte
│ ├ client.js
│ ├ server.js
│ ├ service-worker.js
│ └ template.html
├ static
│ ├ # тут ваши картинки и прочая статика
└ rollup.config.js / webpack.config.js
```

При первом запуске Sapper создаст дополнительный каталог `__sapper__`, содержащий сгенерированные файлы.

Вы заметите несколько дополнительных файлов и каталог `cypress`, которые относятся к процессу [тестирования](docs#Testirovanie) — но в данный момент нам не нужно заострять на этом внимания.

> Вы можете *создать* эти файлы с нуля, но гораздо проще использовать готовый шаблон. См. раздел [Начало работы](docs#Nachalo_raboty) для получения инструкций о том, как легко развернуть шаблон на своём компьютере.

### package.json

Файл package.json содержит зависимости вашего приложения и определяет ряд скриптов:

* `npm run dev` — запустить приложение в режиме разработки и следить за изменениями в исходных файлах
* `npm run build` — собрать приложение для продакшена
* `npm run export` — сгенерировать статическую версию приложениия, если это возможно (см. [Экспортирование](docs#Eksportirovanie))
* `npm start` — запустить приложение для продакшена, если оно уже было собрано до этого
* `npm test` — запустить тесты (см. [Тестирование](docs#Testirovanie))

### src

Тут содержатся три *точки входа* вашего приложения — `src/client.js`, `src/server.js` и (необязательно) `src/service-worker.js` — вместе с файлом `src/template.html`.


#### src/client.js

Здесь *обязательно* нужно импортировать и вызвать функцию `start` из сгенерированного модуля `@sapper/app`:

```js
import * as sapper from '@sapper/app';

sapper.start({
	target: document.querySelector('#sapper')
});
```

Для большинства случаев это весь код модуля, но вы можете дополнительно написать здесь любой код под ваши нужды. Смотрите раздел [API клиента](docs#API_klienta) для получения дополнительной информации о функциях, которые вы можете импортировать.


#### src/server.js

Это обычное Express приложение (можно взять [Polka](https://github.com/lukeed/polka) или ещё какой-либо сервер), с тремя обязательными требованиями:

* оно должно сервить содержимое папки `static`, используя, например, [sirv](https://github.com/lukeed/sirv)
* оно должен вызвать `app.use(sapper.middleware())` в том месте, где `sapper` импортируется из `@sapper/server`
* оно должно 'висеть' на порту, указанном в `process.env.PORT`

В остальном, вы можете написать сервер так, как вам нравится.


#### src/service-worker.js

Сервис-воркеры действуют как прокси-серверы, которые дают вам детальный контроль над тем, как реагировать на сетевые запросы. Например, когда браузер запрашивает `/козлики.jpg`, сервис-воркер может вернуть файл, который он уже ранее закешировал, или он может передать запрос на сервер, или он может даже ответить чем-то совершенно другим, например, картинкой оленей.

Помимо прочего, они позволяют создавать приложения, работающие в автономном режиме.

Поскольку каждому приложению требуется особое поведение сервис-воркеров (одним надо всё отдавать из кэша, другим кеш нужен только при отсутствии подключения), Sapper никак не ограничивает поведение сервис-воркеров. Вы сами пишете его логику в `service-worker.js`. Вы можете импортировать любой из следующих объектов из `@sapper/service-worker`:

* `files` — массив файлов, найденных в директории `static`
* `shell` — JavaScript код для клиента, сгенерированный сборщиком(Rollup или webpack)
* `routes` — массив объектов `{ pattern: RegExp }`, которые вы можете использовать, чтобы определить относится ли к Sapper запрошенная страница
* `timestamp` — время, когда был создан сервис-воркер(полезно для создания уникальных имён кэшей)


#### src/template.html

Этот файл является шаблоном для ответов с сервера. В процессе сборки Sapper будет внедрять контент, заменяющий следующие метки:

* `%sapper.base%` — элемент `<base>` (см. [Базовые URL](docs#Bazovye_URL))
* `%sapper.styles%` — необходимый CSS для запрашиваемой страницы
* `%sapper.head%` — HTML представление специфичного для данной страницы содержимого элемента `<head>`, вроде элемента `<title>`
* `%sapper.html%` — HTML представление содержимого отрендеренной страницы
* `%sapper.scripts%` — элементы `<script>` для клиентской части приложения


### src/routes

Это основа вашего приложения — страницы и маршруты сервера. Подробнее вы узнаете в разделе [Маршруты](docs#Marshruty).


### static

Это место для размещения любых файлов, которые использует ваше приложение — шрифты, изображения и так далее. Например, `static/favicon.png` будет доступна как `/favicon.png`.

Sapper не будет сервить эти файлы. Обычно для этого используют [sirv](https://github.com/lukeed/sirv) или [serve-static](https://github.com/expressjs/serve-static). Но он будет сканировать содержимое папки `static`, чтобы вы могли легко сгенерировать манифест кэша для поддержки автономной работы(см. [service-worker.js](docs#templates-service-worker-js)).


### rollup.config.js / webpack.config.js

Sapper может использовать [Rollup](https://rollupjs.org/) или [webpack](https://webpack.js.org/) для сборки вашего приложения. Скорее всего, вам не понадобится менять их конфигурацию, но при необходимости, вы, конечно, можете, например, добавить новый плагин.